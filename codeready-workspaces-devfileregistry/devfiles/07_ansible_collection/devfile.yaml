---
apiVersion: 1.0.0
metadata:
  generateName: ansible-collection-
projects:
-
    name: ansible-collection-template
    source:
        location: "https://github.com/adelahozredhat/template_ansible_collection"
        branch: develop
        type: git
components:
-
  type: chePlugin
  id: redhat/ansible/latest
-
  type: chePlugin
  id: redhat/vscode-yaml/latest
-
  type: chePlugin
  id: ms-python/python/latest
  preferences:
    python.globalModuleInstallation: true
-
  type: dockerimage
  alias: ansible
  image: image-registry.openshift-image-registry.svc:5000/openshift-workspaces/ansible-test-image
  memoryLimit: 1Gi
  mountSources: true
commands:

-
  name: 1. Execute install module
  actions:
    - type: exec
      component: ansible
      command: "pip install -e ."
      workdir: "${CHE_PROJECTS_ROOT}/ansible-collection-template/ansible_collections/namespace_example/collection_example"

-
  name: 1. Execute build galaxy
  actions:
    - type: exec
      component: ansible
      command: "ansible-galaxy collection build"
      workdir: "${CHE_PROJECTS_ROOT}/ansible-collection-template/ansible_collections/namespace_example/collection_example"

-
  name: 2. Execute sanity
  actions:
    - type: exec
      component: ansible
      command: "ansible-test sanity"
      workdir: "${CHE_PROJECTS_ROOT}/ansible-collection-template/ansible_collections/namespace_example/collection_example"

-
  name: 3. Execute units
  actions:
    - type: exec
      component: ansible
      command: "ansible-test units"
      workdir: "${CHE_PROJECTS_ROOT}/ansible-collection-template/ansible_collections/namespace_example/collection_example"

-
  name: 4. Execute integration
  actions:
    - type: exec
      component: ansible
      command: "ansible-test integration"
      workdir: "${CHE_PROJECTS_ROOT}/ansible-collection-template/ansible_collections/namespace_example/collection_example"

-
  name: 5. Execute coverage
  actions:
    - type: exec
      component: ansible
      command: "ansible-test coverage"
      workdir: "${CHE_PROJECTS_ROOT}/ansible-collection-template/ansible_collections/namespace_example/collection_example"
